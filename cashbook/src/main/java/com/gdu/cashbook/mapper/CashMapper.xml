<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gdu.cashbook.mapper.CashMapper">
	<!-- 로그인한 멤버의 가계부 정보 -->
	<select id="selectCashListByDate" parameterType="com.gdu.cashbook.vo.Cash" resultType="com.gdu.cashbook.vo.Cash">
		SELECT
			cash_no as cashNo,
			cash_kind as cashKind,
			category_name as categoryName,
			cash_price as cashPrice,
			cash_place as cashPlace,
			cash_memo as cashMemo
		FROM cash
		WHERE member_id = #{memberId}
		AND cash_date = #{cashDate}
		ORDER BY cash_no ASC
	</select>
	<!-- 로그인한 가계부 삭제 -->
	<delete id="deleteCashOne" parameterType="com.gdu.cashbook.vo.Cash">
		DELETE
		FROM cash
		WHERE cash_no = #{cashNo}
	</delete>
	<!-- 로그인한 멤버의 오늘 가계부 총합계 , 총합이 null이면 0으로 표시 
		dual=일시적 테이블 테이블명이 없을떄-->
	<select id="selectCashKindSum" parameterType="com.gdu.cashbook.vo.Cash" resultType="int">
		SELECT
			(SELECT IFNULL(SUM(cash_price), 0)
			FROM cash
			WHERE member_id= #{memberId} AND cash_kind = '수입' AND cash_date = #{cashDate})
			-
			(SELECT IFNULL(SUM(cash_price), 0)
			FROM cash
			WHERE member_id= #{memberId} AND cash_kind = '지출' AND cash_date = #{cashDate})
		FROM dual	
	</select>
</mapper>